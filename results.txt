x=[1:16];
b2=[[4400962,4302774,4308423,4427312,4374195];[4400962,4302774,4308423,4427312,4374195];[4400962,4302774,4308423,4427312,4374195];[4400962,4302774,4308423,4427312,4374195];[4400962,4302774,4308423,4427312,4374195];[4400962,4302774,4308423,4427312,4374195];[4400962,4302774,4308423,4427312,4374195];[4400962,4302774,4308423,4427312,4374195];[4400962,4302774,4308423,4427312,4374195];[4400962,4302774,4308423,4427312,4374195];[4400962,4302774,4308423,4427312,4374195];[4400962,4302774,4308423,4427312,4374195];[4400962,4302774,4308423,4427312,4374195];[4400962,4302774,4308423,4427312,4374195];[4400962,4302774,4308423,4427312,4374195];[4400962,4302774,4308423,4427312,4374195]];
y2=[[4454971,4205087,4398470,4344732,4347470];[2389040,2378509,2336046,2421476,2512410];[2522421,2398037,2459087,2405557,2498321];[2322321,2352894,2320594,2374365,2400093];[2360162,2303627,2317324,2393440,2321226];[2305269,2362826,2358619,2441733,2358224];[2484177,2788941,2532195,2500766,2391881];[2476863,2423129,2496556,2452086,2363107];[2486252,2528363,2428714,2494954,2460303];[2483408,2465680,2490726,2453906,2405006];[2346254,2531539,2447208,2502536,2470131];[2429090,2517303,2454410,2446940,2529411];[2530040,2644472,2420723,2720438,2521925];[2401253,2381727,2405401,2449127,2396735];[2379282,2403063,2336637,2417065,2420012];[2409741,2369599,2650509,2617820,2744366]];
z2=[[71058,72699,68171,71930,84251];[200179,153535,149624,152358,163222];[418511,445908,378204,421350,433300];[708067,688287,740287,710105,683047];[1030574,1112697,1123563,1106279,1046882];[1512089,1515529,1506852,1596453,1469695];[2056216,2149900,2049705,2122026,1977078];[2583881,2696957,2951139,2807426,2796930];[4049413,3757618,3814964,3762011,3647800];[4826303,4882752,4733860,4805770,4914127];[6154631,6188008,6188742,6096984,6129529];[7284812,7239862,7371798,7214284,7203789];[8833762,8932155,8835670,8775669,8836025];[10766447,10257257,9897417,10358911,10565390];[11757867,11859933,11966429,11760316,11979698];[13900671,13997500,13840477,14085660,14028279]];
b3=[[4343518,4280903,4284025,4258205,4248379];[4343518,4280903,4284025,4258205,4248379];[4343518,4280903,4284025,4258205,4248379];[4343518,4280903,4284025,4258205,4248379];[4343518,4280903,4284025,4258205,4248379];[4343518,4280903,4284025,4258205,4248379];[4343518,4280903,4284025,4258205,4248379];[4343518,4280903,4284025,4258205,4248379];[4343518,4280903,4284025,4258205,4248379];[4343518,4280903,4284025,4258205,4248379];[4343518,4280903,4284025,4258205,4248379];[4343518,4280903,4284025,4258205,4248379];[4343518,4280903,4284025,4258205,4248379];[4343518,4280903,4284025,4258205,4248379];[4343518,4280903,4284025,4258205,4248379];[4343518,4280903,4284025,4258205,4248379]];
y3=[[4226101,4272377,4294203,4235023,4398568];[2386284,2311182,2405560,2406727,2331576];[1784119,1759386,1780333,1743284,1896247];[1810612,1952015,1846503,1973855,1894612];[1692191,1721002,1618171,1657710,1655758];[1627639,1698380,1655208,1587643,1567609];[1813225,1655881,1675507,1724303,1760644];[1704426,1864620,1691659,1657732,1725959];[1643692,1786408,1689012,1683832,1795357];[1639492,1607857,1754114,1679003,1665934];[1710474,1649815,1699757,1661295,1650620];[1682028,1635170,1660293,1660709,1613884];[1635021,1672864,1688114,1660235,1664805];[1662602,1722457,1685255,1686657,1770612];[1669079,1718304,1724249,1713101,1606829];[1691309,1592758,1665589,1700344,1641952]];
z3=[[67471,72005,65977,73229,73168];[154873,174680,161407,198693,149554];[264888,250440,314172,266846,307212];[519864,496080,530119,499280,498580];[725660,751207,686212,746709,670784];[1065650,972790,1023084,989971,1037687];[1269806,1320671,1257127,1352828,1314244];[1697421,1682801,1720916,1783406,1617085];[2473196,2371617,2367146,2395690,2339196];[3175855,3181441,3162724,3225152,3222542];[4263746,4207241,4192687,4181117,4204029];[5215403,5174008,5273326,5202792,5145972];[6222070,6281911,6290023,6256963,6098797];[7335610,7335096,7311435,7377848,7426738];[8517000,8484734,8682527,8464600,8427323];[9846687,9622584,9685097,9754935,9747846]];
x=[1:16]
b4=[[4403783,4277271,4305434,4271890,4293771];[4403783,4277271,4305434,4271890,4293771];[4403783,4277271,4305434,4271890,4293771];[4403783,4277271,4305434,4271890,4293771];[4403783,4277271,4305434,4271890,4293771];[4403783,4277271,4305434,4271890,4293771];[4403783,4277271,4305434,4271890,4293771];[4403783,4277271,4305434,4271890,4293771];[4403783,4277271,4305434,4271890,4293771];[4403783,4277271,4305434,4271890,4293771];[4403783,4277271,4305434,4271890,4293771];[4403783,4277271,4305434,4271890,4293771];[4403783,4277271,4305434,4271890,4293771];[4403783,4277271,4305434,4271890,4293771];[4403783,4277271,4305434,4271890,4293771];[4403783,4277271,4305434,4271890,4293771]];
y4=[[4368405,4346988,4331284,4405448,4419154];[2302854,2450657,2262132,2416275,2337918];[1770359,1729998,1806192,1848846,1719212];[1547531,1514765,1535820,1526549,1479320];[1541221,1506134,1679735,1616499,1633243];[1537749,1570548,1480170,1556235,1446042];[1479911,1464672,1448665,1389454,1486157];[1576507,1447890,1490151,1461239,1447470];[1498826,1478191,1515341,1439484,1465888];[1444929,1551919,1492923,1509564,1453988];[1398865,1454761,1390398,1432389,1389937];[1413845,1443424,1435554,1415895,1442687];[1464737,1431407,1370375,1530233,1403807];[1419886,1419307,1418541,1359013,1428091];[1440014,1413876,1437675,1418121,1391538];[1415341,1380614,1453222,1502524,1411558]];
z4=[[67856,69784,71719,69566,79492];[171710,161259,151704,180255,153477];[288899,291175,265321,288803,291837];[469690,474308,430943,438496,408896];[630236,701423,631699,631387,646127];[905983,913355,893920,905878,886262];[1128941,1177508,1138491,1140510,1153839];[1430316,1448115,1489657,1432677,1481128];[2263897,2266579,2117268,2212968,2156601];[2924081,2861894,2964771,2919057,2951316];[3706806,3593266,3691665,3685633,3685393];[4631673,4608999,4574797,4647843,4560619];[5685357,5514948,5660133,5402634,5467807];[6611620,6486640,6573407,6478895,6441402];[7832110,7548431,7482007,7559305,7703318];[8678918,8637302,8645723,8532834,8895640]];
b5=[[4554436,4329293,4966230,4602827,4702080];[4554436,4329293,4966230,4602827,4702080];[4554436,4329293,4966230,4602827,4702080];[4554436,4329293,4966230,4602827,4702080];[4554436,4329293,4966230,4602827,4702080];[4554436,4329293,4966230,4602827,4702080];[4554436,4329293,4966230,4602827,4702080];[4554436,4329293,4966230,4602827,4702080];[4554436,4329293,4966230,4602827,4702080];[4554436,4329293,4966230,4602827,4702080];[4554436,4329293,4966230,4602827,4702080];[4554436,4329293,4966230,4602827,4702080];[4554436,4329293,4966230,4602827,4702080];[4554436,4329293,4966230,4602827,4702080];[4554436,4329293,4966230,4602827,4702080];[4554436,4329293,4966230,4602827,4702080]];
y5=[[4627417,4460538,4398260,4347972,4320077];[2326910,2340638,2364690,2350234,2329886];[1925253,1831120,1765650,1854624,1684661];[1495721,1576436,1535937,1521224,1477036];[1498140,1369200,1381576,1493681,1470727];[1550751,1474564,1512867,1448428,1496727];[1445399,1422730,1429807,1448897,1408411];[1409008,1367092,1372041,1691501,1563578];[1561831,1360025,1410165,1386319,1340214];[1323568,1372374,1365254,1399767,1348329];[1379626,1379730,1370731,1382011,1421036];[1420662,1324309,1398310,1329555,1357023];[1337862,1382605,1385259,1352905,1389198];[1411336,1410689,1302509,1416372,1322701];[1361223,1386498,1305153,1377286,1331710];[1364405,1357770,1368081,1289883,1378201]];
z5=[[72125,64986,75820,71059,65202];[158844,162639,166861,167339,151413];[311846,316701,311421,285495,312038];[436212,399364,415622,421590,364546];[589906,550314,601283,594743,651838];[859234,828928,869170,866351,837805];[1131374,1089433,1130682,1102939,1182701];[1353183,1457656,1430804,1471663,1457949];[2146827,2127973,2218034,2156558,2056537];[2972201,2830589,2869474,2844260,2918130];[3596516,3557190,3515593,3616742,3611167];[4601277,4445586,4424889,4274344,4339920];[5424071,5203975,5317826,5187500,5398840];[5993535,5817698,5788112,5856729,5822599];[7517759,7195771,7041344,7083782,7369781];[8487720,8370649,8639933,8414669,8267915]];
b6=[[4358112,4297256,4367688,4316851,4358550];[4358112,4297256,4367688,4316851,4358550];[4358112,4297256,4367688,4316851,4358550];[4358112,4297256,4367688,4316851,4358550];[4358112,4297256,4367688,4316851,4358550];[4358112,4297256,4367688,4316851,4358550];[4358112,4297256,4367688,4316851,4358550];[4358112,4297256,4367688,4316851,4358550];[4358112,4297256,4367688,4316851,4358550];[4358112,4297256,4367688,4316851,4358550];[4358112,4297256,4367688,4316851,4358550];[4358112,4297256,4367688,4316851,4358550];[4358112,4297256,4367688,4316851,4358550];[4358112,4297256,4367688,4316851,4358550];[4358112,4297256,4367688,4316851,4358550];[4358112,4297256,4367688,4316851,4358550]];
y6=[[4291976,4303051,4498008,4542154,4342813];[2408493,2471799,2313990,2288568,2359148];[1837274,1777774,1734585,1799402,1682837];[1535461,1509174,1433222,1426824,1689424];[1475748,1563043,1471358,1304671,1440796];[1324554,1356765,1296950,1337189,1383013];[1432666,1408808,1397421,1421284,1392407];[1410827,1395562,1330221,1354136,1349589];[1329586,1324511,1330012,1301556,1384965];[1256605,1299205,1290661,1354627,1298758];[1366515,1321856,1343521,1286483,1322743];[1264262,1335913,1325037,1304446,1297101];[1307748,1288944,1332655,1272959,1357337];[1262836,1348323,1271745,1282299,1276137];[1238775,1285178,1259451,1279706,1286613];[1335685,1243449,1302230,1291304,1329083]];
z6=[[67700,71624,65364,71429,70615];[192937,193052,159348,184361,163055];[296971,278986,317975,299055,271223];[403240,399112,418163,433868,405234];[643275,606068,617603,581072,604431];[842785,768078,761241,790321,777770];[1070521,1060424,1139405,1043586,1053234];[1337354,1353190,1330770,1310575,1336453];[2052710,2030789,2037361,1944188,1985880];[2800503,2768542,2659415,2695008,2793688];[3414836,3397531,3458189,3410237,3399659];[4218901,4189247,4307202,4155276,4207945];[5221078,5247962,5258452,5271692,5072649];[6160966,6133583,6051419,6096693,6105924];[7300853,7108182,6969374,7168814,7136563];[8443137,8317005,8150241,8383896,8422133]];
b7=[[4352081,4378705,4381799,4349617,4357966];[4352081,4378705,4381799,4349617,4357966];[4352081,4378705,4381799,4349617,4357966];[4352081,4378705,4381799,4349617,4357966];[4352081,4378705,4381799,4349617,4357966];[4352081,4378705,4381799,4349617,4357966];[4352081,4378705,4381799,4349617,4357966];[4352081,4378705,4381799,4349617,4357966];[4352081,4378705,4381799,4349617,4357966];[4352081,4378705,4381799,4349617,4357966];[4352081,4378705,4381799,4349617,4357966];[4352081,4378705,4381799,4349617,4357966];[4352081,4378705,4381799,4349617,4357966];[4352081,4378705,4381799,4349617,4357966];[4352081,4378705,4381799,4349617,4357966];[4352081,4378705,4381799,4349617,4357966]];
y7=[[4308226,4396796,4423773,4321253,4334988];[2338433,2317782,2287666,2308367,2443498];[1806564,1873940,1841620,1766578,1745988];[1631716,1548621,1503306,1517704,1490250];[1417352,1400502,1410180,1369315,1465083];[1316455,1315209,1280684,1301999,1283853];[1318855,1256721,1292577,1384992,1254676];[1287849,1300972,1344367,1306276,1299922];[1341741,1253672,1313466,1274084,1233443];[1242933,1306005,1231466,1389735,1226933];[1222324,1205554,1222710,1216214,1279531];[1233680,1189880,1267074,1229929,1266962];[1251962,1244795,1292102,1248526,1215467];[1288248,1202383,1239885,1223648,1234612];[1210124,1224469,1204515,1246729,1197684];[1260680,1181270,1179122,1155274,1140882]];
z7=[[70244,68898,67466,72072,69186];[170609,170894,169517,172839,181349];[233388,371132,266831,314832,245299];[401027,474265,508668,434888,402111];[588131,520324,598740,618873,591786];[746888,739783,743256,866739,752290];[930465,938477,974737,959263,939532];[1282954,1331813,1274585,1285536,1243369];[1906579,1864217,1860880,1935851,1864661];[2493732,2492160,2592160,2565928,2543398];[3118592,3090245,3330359,3144663,3219012];[4086975,3943373,4030748,4106022,4220223];[4979092,5003583,5158040,4918467,5106352];[5911406,5906094,6238741,6152122,6274906];[7486905,7300437,7203366,7318627,7461509];[8710759,8535907,8699886,8655267,8809461]];

close all
figure
hold on
set(gca, "linewidth", 4, "fontsize", 18);
h1=errorbar(x(1:10),mean(y2')(1:10), sqrt(var(y2')(1:10)), 'b');
set(h1, "linewidth", 4, "linestyle", "-.");
h2=errorbar(x(1:10),mean(y3')(1:10), sqrt(var(y3')(1:10)), 'g');
set(h2, "linewidth", 4, "linestyle", '--');
h3=errorbar(x(1:10),mean(y4')(1:10), sqrt(var(y4')(1:10)), 'r');
set(h3, "linewidth", 4, "linestyle", ':');
h4=errorbar(x(1:10),mean(y5')(1:10), sqrt(var(y5')(1:10)), 'm');
set(h4, "linewidth", 4, "linestyle", '-');
h6=errorbar(x(1:10),mean(y7')(1:10), sqrt(var(y7')(1:10)), 'c');
set(h6, "linewidth", 4, "linestyle", '-');
h7=errorbar(x(1:10),mean(b4')(1:10), sqrt(var(b4')(1:10)), 'k');
set(h7, "linewidth", 4, "linestyle", '-');

hx=xlabel('Number of Threads');
hy=ylabel('Exec Time (u secs)');
legend([h7,h1,h2,h3,h4,h6], 'Baseline', '2 Cores', '3 Cores', '4 Cores', '5 Cores', '8 Cores');
ht=title('Exec Time x Number of Threads for Different Number of Cores.');
set(hx, "fontsize", 20);
set(hy, "fontsize", 20);
set(ht, "fontsize", 20);

%h5=h=errorbar(x(1:10),mean(y6')(1:10), sqrt(var(y6')(1:10)), 'c');
%set(h5, "linewidth", 4, "linestyle", '-');
%errorbar(x(1:10),mean(b2')(1:10), sqrt(var(b2')(1:10)), 'r');
%errorbar(x(1:10),mean(b3')(1:10), sqrt(var(b3')(1:10)), 'r');
%errorbar(x(1:10),mean(b5')(1:10), sqrt(var(b5')(1:10)), 'g');
%errorbar(x(1:10),mean(b6')(1:10), sqrt(var(b6')(1:10)), 'g');
%errorbar(x(1:10),mean(b7')(1:10), sqrt(var(b7')(1:10)), 'k');

close all
figure
h0=plot(x(1:10), z2(1).*(1:10),'k');
hold on
h1=errorbar(x(1:10),mean(z2')(1:10)./x(1:10), sqrt(var(z2'(1:10)./x(1:10))), 'b');
h2=errorbar(x(1:10),mean(z3')(1:10)./x(1:10), sqrt(var(z3'(1:10)./x(1:10))), 'r');
h3=errorbar(x(1:10),mean(z7')(1:10)./x(1:10), sqrt(var(z7'(1:10)./x(1:10))), 'g');
hx=xlabel('Number of Threads');
hy=ylabel('Exec Time (u secs)');
ht=title('Exec Time x Number of Threads for Different Number of Cores.');
set(hx, "fontsize", 20);
set(hy, "fontsize", 20);
set(ht, "fontsize", 20);
set(gca, "linewidth", 4, "fontsize", 18);
legend([h0,h1,h2,h3], 'Baseline', '2 Cores', '3 Cores', '7 Cores', 'location', 'northwest');


%errorbar(x(1:10),mean(z4')(1:10)./x(1:10), sqrt(var(z4')(1:10)));
%errorbar(x(1:10),mean(z5')(1:10)./x(1:10), sqrt(var(z5')(1:10)), 'g');
%errorbar(x(1:10),mean(z6')(1:10)./x(1:10), sqrt(var(z6')(1:10)), 'g');